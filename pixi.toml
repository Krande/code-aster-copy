[project]
name = "code-aster"
version = "17.1.12"
description = "A pixi project for building the windows variant of code aster"
channels = ["https://repo.prefix.dev/code-aster", "conda-forge"]
platforms = ["win-64"]

[dependencies]
python = "3.12.4"
vswhere = "*"
libboost-devel = "1.84"
libblas = { version = "*", build = "*mkl" }
liblapack = { version = "*", build = "*mkl" }
mkl-devel = "2024.1"
intel-fortran-rt = "2024.1"
waf = "2.0.27"
numpy = "1.26"
pyyaml = "*"
pytest = "*"
python-dotenv = "*"
cmake = "*"
ninja = "*"
psutil = "*"
pybind11 = "2.13.1"
setuptools = "*"
clang = "18.1.8"
mfront = { version = "*", build = "*debug*" }
mgis = { version = "*", build = "*debug*" }
libmed = { version = "*", build = "*debug*" }
medcoupling = { version = "*", build = "*debug*" }
scotch = { version = "*", build = "*debug*" }
metis = { version = "*", build = "*debug*" }
mumps = { version = "*", build = "*debug*" }

[tasks]
configure = { cmd = ["ifx_env.bat"], description = "set up ifx environment", env = {FC="ifx.exe"} }
build = { cmd = ["conda_manual_build.bat", "--pixi-build"], description = "Build the project", env = { RUNASTER_ROOT = "%CONDA_PREFIX%/Library", ASTER_ROOT = "%CONDA_PREFIX%" } }
bibfor_cmake = { cmd = [
    "cmake", "-B", "build-cmake", "-G", "Ninja",
    "-DBUILD_BIBFOR=ON",
    "-DWIN32_LEAN_AND_MEAN=ON",
    "-DCMAKE_BUILD_TYPE=release",
    "--fresh"
], depends-on = ["configure"], description = "Configure the project for building bibfor", env = {CC="clang-cl", CXX="clang-cl"} }