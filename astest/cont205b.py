# coding=utf-8
# --------------------------------------------------------------------
# Copyright (C) 1991 - 2025 - EDF R&D - www.code-aster.org
# This file is part of code_aster.
#
# code_aster is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# code_aster is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with code_aster.  If not, see <http://www.gnu.org/licenses/>.
# --------------------------------------------------------------------
## - Pairing test in 3D for linear meshes: TETRA4 vs TETRA4

from code_aster.Commands import *
from code_aster import CA
from enum import Enum
from code_aster.MacroCommands.defi_cont import DEFI_CONT
from libaster import ContactPairing, ContactComputation, PairingMethod
import numpy

# -------------------------------------
#       - Reference solution
# -------------------------------------
"""
    1: SLAVE = CONT_BAS + PairingMethod.Fast
"""
refValues = {
    1: {
        "nbPairs": 292,
        "listPairs": [
            (589, 673),
            (589, 701),
            (589, 690),
            (589, 741),
            (589, 751),
            (589, 763),
            (589, 771),
            (589, 811),
            (589, 812),
            (589, 830),
            (589, 831),
            (589, 839),
            (590, 830),
            (590, 811),
            (590, 829),
            (590, 763),
            (590, 795),
            (590, 741),
            (590, 773),
            (590, 701),
            (590, 749),
            (590, 673),
            (590, 702),
            (597, 839),
            (597, 823),
            (597, 831),
            (597, 793),
            (597, 822),
            (597, 812),
            (597, 762),
            (597, 771),
            (597, 796),
            (597, 689),
            (597, 761),
            (597, 751),
            (597, 690),
            (597, 673),
            (599, 702),
            (599, 675),
            (599, 749),
            (599, 701),
            (599, 676),
            (599, 731),
            (599, 773),
            (599, 673),
            (599, 795),
            (599, 829),
            (566, 822),
            (566, 823),
            (566, 846),
            (566, 839),
            (603, 673),
            (603, 652),
            (603, 690),
            (603, 651),
            (603, 689),
            (603, 669),
            (603, 762),
            (603, 692),
            (603, 761),
            (603, 754),
            (603, 691),
            (603, 796),
            (603, 822),
            (598, 829),
            (598, 795),
            (598, 773),
            (598, 805),
            (598, 749),
            (598, 774),
            (598, 825),
            (598, 731),
            (598, 732),
            (598, 819),
            (598, 827),
            (598, 676),
            (598, 838),
            (598, 787),
            (609, 673),
            (609, 652),
            (609, 701),
            (609, 672),
            (609, 702),
            (609, 660),
            (609, 675),
            (609, 635),
            (609, 657),
            (609, 676),
            (609, 634),
            (609, 615),
            (609, 670),
            (609, 614),
            (565, 846),
            (565, 822),
            (607, 691),
            (607, 664),
            (607, 692),
            (607, 650),
            (607, 684),
            (607, 669),
            (607, 635),
            (607, 651),
            (607, 679),
            (607, 660),
            (607, 634),
            (607, 652),
            (607, 672),
            (607, 614),
            (607, 673),
            (601, 822),
            (601, 796),
            (601, 761),
            (601, 804),
            (601, 754),
            (601, 803),
            (601, 692),
            (601, 766),
            (601, 848),
            (601, 691),
            (601, 765),
            (601, 867),
            (601, 816),
            (601, 743),
            (601, 788),
            (584, 827),
            (584, 825),
            (600, 787),
            (600, 827),
            (600, 838),
            (600, 819),
            (600, 735),
            (600, 734),
            (600, 774),
            (600, 733),
            (600, 730),
            (600, 732),
            (600, 659),
            (600, 671),
            (600, 731),
            (600, 658),
            (600, 670),
            (600, 676),
            (608, 614),
            (608, 615),
            (608, 636),
            (608, 657),
            (608, 658),
            (608, 670),
            (608, 659),
            (608, 671),
            (608, 676),
            (582, 822),
            (582, 846),
            (604, 614),
            (604, 634),
            (604, 679),
            (604, 684),
            (604, 699),
            (604, 664),
            (604, 745),
            (604, 714),
            (604, 691),
            (604, 760),
            (604, 750),
            (604, 729),
            (604, 743),
            (604, 782),
            (604, 794),
            (604, 801),
            (604, 849),
            (604, 850),
            (596, 867),
            (596, 848),
            (596, 803),
            (596, 804),
            (596, 796),
            (596, 822),
            (596, 846),
            (602, 788),
            (602, 765),
            (602, 816),
            (602, 781),
            (602, 743),
            (602, 848),
            (602, 837),
            (602, 760),
            (602, 783),
            (602, 691),
            (602, 867),
            (602, 859),
            (602, 745),
            (602, 851),
            (602, 782),
            (602, 750),
            (602, 849),
            (602, 794),
            (602, 801),
            (602, 850),
            (593, 659),
            (593, 733),
            (593, 735),
            (593, 726),
            (593, 838),
            (593, 787),
            (594, 659),
            (594, 656),
            (594, 658),
            (594, 646),
            (594, 698),
            (594, 636),
            (594, 624),
            (594, 616),
            (594, 680),
            (594, 615),
            (594, 623),
            (594, 637),
            (594, 704),
            (594, 614),
            (594, 645),
            (594, 625),
            (606, 850),
            (606, 821),
            (606, 849),
            (606, 800),
            (606, 801),
            (606, 792),
            (606, 799),
            (606, 794),
            (606, 718),
            (606, 728),
            (606, 729),
            (606, 713),
            (606, 727),
            (606, 714),
            (606, 700),
            (606, 687),
            (606, 699),
            (606, 678),
            (606, 655),
            (606, 679),
            (606, 645),
            (606, 634),
            (606, 614),
            (570, 850),
            (570, 821),
            (570, 849),
            (570, 868),
            (570, 851),
            (570, 859),
            (570, 837),
            (592, 726),
            (592, 698),
            (592, 735),
            (592, 656),
            (592, 680),
            (592, 733),
            (592, 659),
            (592, 704),
            (591, 625),
            (591, 622),
            (591, 637),
            (591, 644),
            (591, 616),
            (591, 613),
            (591, 646),
            (591, 633),
            (591, 624),
            (591, 623),
            (591, 645),
            (591, 614),
            (595, 792),
            (595, 800),
            (595, 821),
            (595, 850),
            (605, 614),
            (605, 645),
            (605, 623),
            (605, 655),
            (605, 633),
            (605, 687),
            (605, 613),
            (605, 678),
            (605, 644),
            (605, 700),
            (605, 622),
            (605, 654),
            (605, 713),
            (605, 718),
            (569, 821),
            (569, 850),
            (583, 850),
            (583, 821),
        ],
    },
    2: {
        "nbPairs": 292,
        "listPairs": [
            (589, 673),
            (589, 701),
            (589, 690),
            (589, 741),
            (589, 751),
            (589, 763),
            (589, 771),
            (589, 811),
            (589, 812),
            (589, 830),
            (589, 831),
            (589, 839),
            (590, 830),
            (590, 811),
            (590, 829),
            (590, 763),
            (590, 795),
            (590, 741),
            (590, 773),
            (590, 701),
            (590, 749),
            (590, 673),
            (590, 702),
            (597, 839),
            (597, 823),
            (597, 831),
            (597, 793),
            (597, 822),
            (597, 812),
            (597, 762),
            (597, 771),
            (597, 796),
            (597, 689),
            (597, 761),
            (597, 751),
            (597, 690),
            (597, 673),
            (599, 702),
            (599, 675),
            (599, 749),
            (599, 701),
            (599, 676),
            (599, 731),
            (599, 773),
            (599, 673),
            (599, 795),
            (599, 829),
            (566, 822),
            (566, 823),
            (566, 846),
            (566, 839),
            (603, 673),
            (603, 652),
            (603, 690),
            (603, 651),
            (603, 689),
            (603, 669),
            (603, 762),
            (603, 692),
            (603, 761),
            (603, 754),
            (603, 691),
            (603, 796),
            (603, 822),
            (598, 829),
            (598, 795),
            (598, 773),
            (598, 805),
            (598, 749),
            (598, 774),
            (598, 825),
            (598, 731),
            (598, 732),
            (598, 819),
            (598, 827),
            (598, 676),
            (598, 838),
            (598, 787),
            (609, 673),
            (609, 652),
            (609, 701),
            (609, 672),
            (609, 702),
            (609, 660),
            (609, 675),
            (609, 635),
            (609, 657),
            (609, 676),
            (609, 634),
            (609, 615),
            (609, 670),
            (609, 614),
            (565, 846),
            (565, 822),
            (607, 691),
            (607, 664),
            (607, 692),
            (607, 650),
            (607, 684),
            (607, 669),
            (607, 635),
            (607, 651),
            (607, 679),
            (607, 660),
            (607, 634),
            (607, 652),
            (607, 672),
            (607, 614),
            (607, 673),
            (601, 822),
            (601, 796),
            (601, 761),
            (601, 804),
            (601, 754),
            (601, 803),
            (601, 692),
            (601, 766),
            (601, 848),
            (601, 691),
            (601, 765),
            (601, 867),
            (601, 816),
            (601, 743),
            (601, 788),
            (584, 827),
            (584, 825),
            (600, 787),
            (600, 827),
            (600, 838),
            (600, 819),
            (600, 735),
            (600, 734),
            (600, 774),
            (600, 733),
            (600, 730),
            (600, 732),
            (600, 659),
            (600, 671),
            (600, 731),
            (600, 658),
            (600, 670),
            (600, 676),
            (608, 614),
            (608, 615),
            (608, 636),
            (608, 657),
            (608, 658),
            (608, 670),
            (608, 659),
            (608, 671),
            (608, 676),
            (582, 822),
            (582, 846),
            (604, 614),
            (604, 634),
            (604, 679),
            (604, 684),
            (604, 699),
            (604, 664),
            (604, 745),
            (604, 714),
            (604, 691),
            (604, 760),
            (604, 750),
            (604, 729),
            (604, 743),
            (604, 782),
            (604, 794),
            (604, 801),
            (604, 849),
            (604, 850),
            (596, 867),
            (596, 848),
            (596, 803),
            (596, 804),
            (596, 796),
            (596, 822),
            (596, 846),
            (602, 788),
            (602, 765),
            (602, 816),
            (602, 781),
            (602, 743),
            (602, 848),
            (602, 837),
            (602, 760),
            (602, 783),
            (602, 691),
            (602, 867),
            (602, 859),
            (602, 745),
            (602, 851),
            (602, 782),
            (602, 750),
            (602, 849),
            (602, 794),
            (602, 801),
            (602, 850),
            (593, 659),
            (593, 733),
            (593, 735),
            (593, 726),
            (593, 838),
            (593, 787),
            (594, 659),
            (594, 656),
            (594, 658),
            (594, 646),
            (594, 698),
            (594, 636),
            (594, 624),
            (594, 616),
            (594, 680),
            (594, 615),
            (594, 623),
            (594, 637),
            (594, 704),
            (594, 614),
            (594, 645),
            (594, 625),
            (606, 850),
            (606, 821),
            (606, 849),
            (606, 800),
            (606, 801),
            (606, 792),
            (606, 799),
            (606, 794),
            (606, 718),
            (606, 728),
            (606, 729),
            (606, 713),
            (606, 727),
            (606, 714),
            (606, 700),
            (606, 687),
            (606, 699),
            (606, 678),
            (606, 655),
            (606, 679),
            (606, 645),
            (606, 634),
            (606, 614),
            (570, 850),
            (570, 821),
            (570, 849),
            (570, 868),
            (570, 851),
            (570, 859),
            (570, 837),
            (592, 726),
            (592, 698),
            (592, 735),
            (592, 656),
            (592, 680),
            (592, 733),
            (592, 659),
            (592, 704),
            (591, 625),
            (591, 622),
            (591, 637),
            (591, 644),
            (591, 616),
            (591, 613),
            (591, 646),
            (591, 633),
            (591, 624),
            (591, 623),
            (591, 645),
            (591, 614),
            (595, 792),
            (595, 800),
            (595, 821),
            (595, 850),
            (605, 614),
            (605, 645),
            (605, 623),
            (605, 655),
            (605, 633),
            (605, 687),
            (605, 613),
            (605, 678),
            (605, 644),
            (605, 700),
            (605, 622),
            (605, 654),
            (605, 713),
            (605, 718),
            (569, 821),
            (569, 850),
            (583, 850),
            (583, 821),
        ],
    },
    3: {
        "nbPairs": 292,
        "listPairs": [
            (565, 822),
            (565, 846),
            (566, 822),
            (566, 823),
            (566, 839),
            (566, 846),
            (569, 821),
            (569, 850),
            (570, 821),
            (570, 837),
            (570, 849),
            (570, 850),
            (570, 851),
            (570, 859),
            (570, 868),
            (582, 822),
            (582, 846),
            (583, 821),
            (583, 850),
            (584, 825),
            (584, 827),
            (589, 673),
            (589, 690),
            (589, 701),
            (589, 741),
            (589, 751),
            (589, 763),
            (589, 771),
            (589, 811),
            (589, 812),
            (589, 830),
            (589, 831),
            (589, 839),
            (590, 673),
            (590, 701),
            (590, 702),
            (590, 741),
            (590, 749),
            (590, 763),
            (590, 773),
            (590, 795),
            (590, 811),
            (590, 829),
            (590, 830),
            (591, 613),
            (591, 614),
            (591, 616),
            (591, 622),
            (591, 623),
            (591, 624),
            (591, 625),
            (591, 633),
            (591, 637),
            (591, 644),
            (591, 645),
            (591, 646),
            (592, 656),
            (592, 659),
            (592, 680),
            (592, 698),
            (592, 704),
            (592, 726),
            (592, 733),
            (592, 735),
            (593, 659),
            (593, 726),
            (593, 733),
            (593, 735),
            (593, 787),
            (593, 838),
            (594, 614),
            (594, 615),
            (594, 616),
            (594, 623),
            (594, 624),
            (594, 625),
            (594, 636),
            (594, 637),
            (594, 645),
            (594, 646),
            (594, 656),
            (594, 658),
            (594, 659),
            (594, 680),
            (594, 698),
            (594, 704),
            (595, 792),
            (595, 800),
            (595, 821),
            (595, 850),
            (596, 796),
            (596, 803),
            (596, 804),
            (596, 822),
            (596, 846),
            (596, 848),
            (596, 867),
            (597, 673),
            (597, 689),
            (597, 690),
            (597, 751),
            (597, 761),
            (597, 762),
            (597, 771),
            (597, 793),
            (597, 796),
            (597, 812),
            (597, 822),
            (597, 823),
            (597, 831),
            (597, 839),
            (598, 676),
            (598, 731),
            (598, 732),
            (598, 749),
            (598, 773),
            (598, 774),
            (598, 787),
            (598, 795),
            (598, 805),
            (598, 819),
            (598, 825),
            (598, 827),
            (598, 829),
            (598, 838),
            (599, 673),
            (599, 675),
            (599, 676),
            (599, 701),
            (599, 702),
            (599, 731),
            (599, 749),
            (599, 773),
            (599, 795),
            (599, 829),
            (600, 658),
            (600, 659),
            (600, 670),
            (600, 671),
            (600, 676),
            (600, 730),
            (600, 731),
            (600, 732),
            (600, 733),
            (600, 734),
            (600, 735),
            (600, 774),
            (600, 787),
            (600, 819),
            (600, 827),
            (600, 838),
            (601, 691),
            (601, 692),
            (601, 743),
            (601, 754),
            (601, 761),
            (601, 765),
            (601, 766),
            (601, 788),
            (601, 796),
            (601, 803),
            (601, 804),
            (601, 816),
            (601, 822),
            (601, 848),
            (601, 867),
            (602, 691),
            (602, 743),
            (602, 745),
            (602, 750),
            (602, 760),
            (602, 765),
            (602, 781),
            (602, 782),
            (602, 783),
            (602, 788),
            (602, 794),
            (602, 801),
            (602, 816),
            (602, 837),
            (602, 848),
            (602, 849),
            (602, 850),
            (602, 851),
            (602, 859),
            (602, 867),
            (603, 651),
            (603, 652),
            (603, 669),
            (603, 673),
            (603, 689),
            (603, 690),
            (603, 691),
            (603, 692),
            (603, 754),
            (603, 761),
            (603, 762),
            (603, 796),
            (603, 822),
            (604, 614),
            (604, 634),
            (604, 664),
            (604, 679),
            (604, 684),
            (604, 691),
            (604, 699),
            (604, 714),
            (604, 729),
            (604, 743),
            (604, 745),
            (604, 750),
            (604, 760),
            (604, 782),
            (604, 794),
            (604, 801),
            (604, 849),
            (604, 850),
            (605, 613),
            (605, 614),
            (605, 622),
            (605, 623),
            (605, 633),
            (605, 644),
            (605, 645),
            (605, 654),
            (605, 655),
            (605, 678),
            (605, 687),
            (605, 700),
            (605, 713),
            (605, 718),
            (606, 614),
            (606, 634),
            (606, 645),
            (606, 655),
            (606, 678),
            (606, 679),
            (606, 687),
            (606, 699),
            (606, 700),
            (606, 713),
            (606, 714),
            (606, 718),
            (606, 727),
            (606, 728),
            (606, 729),
            (606, 792),
            (606, 794),
            (606, 799),
            (606, 800),
            (606, 801),
            (606, 821),
            (606, 849),
            (606, 850),
            (607, 614),
            (607, 634),
            (607, 635),
            (607, 650),
            (607, 651),
            (607, 652),
            (607, 660),
            (607, 664),
            (607, 669),
            (607, 672),
            (607, 673),
            (607, 679),
            (607, 684),
            (607, 691),
            (607, 692),
            (608, 614),
            (608, 615),
            (608, 636),
            (608, 657),
            (608, 658),
            (608, 659),
            (608, 670),
            (608, 671),
            (608, 676),
            (609, 614),
            (609, 615),
            (609, 634),
            (609, 635),
            (609, 652),
            (609, 657),
            (609, 660),
            (609, 670),
            (609, 672),
            (609, 673),
            (609, 675),
            (609, 676),
            (609, 701),
            (609, 702),
        ],
    },
    4: {
        "nbPairs": 187,
        "listPairs": [
            (614, 591),
            (614, 605),
            (615, 591),
            (615, 594),
            (634, 605),
            (634, 606),
            (634, 604),
            (645, 605),
            (645, 573),
            (645, 572),
            (636, 592),
            (636, 588),
            (636, 580),
            (636, 587),
            (657, 594),
            (657, 608),
            (635, 604),
            (635, 607),
            (635, 609),
            (635, 608),
            (679, 604),
            (679, 606),
            (623, 572),
            (623, 544),
            (623, 509),
            (655, 573),
            (655, 558),
            (655, 559),
            (624, 580),
            (624, 553),
            (624, 509),
            (658, 588),
            (658, 592),
            (658, 560),
            (670, 600),
            (670, 593),
            (670, 592),
            (660, 608),
            (660, 609),
            (650, 607),
            (650, 603),
            (650, 604),
            (684, 604),
            (684, 602),
            (699, 606),
            (699, 595),
            (687, 531),
            (687, 512),
            (687, 510),
            (687, 548),
            (659, 560),
            (659, 543),
            (659, 574),
            (659, 508),
            (659, 557),
            (659, 552),
            (676, 600),
            (676, 598),
            (672, 609),
            (672, 599),
            (651, 603),
            (651, 607),
            (664, 604),
            (664, 602),
            (664, 601),
            (745, 570),
            (745, 569),
            (714, 595),
            (714, 583),
            (714, 532),
            (727, 512),
            (727, 511),
            (727, 531),
            (727, 513),
            (727, 530),
            (727, 514),
            (656, 508),
            (733, 526),
            (733, 557),
            (733, 525),
            (733, 542),
            (731, 584),
            (731, 571),
            (731, 578),
            (731, 541),
            (731, 551),
            (731, 506),
            (675, 598),
            (675, 599),
            (652, 599),
            (652, 590),
            (652, 609),
            (652, 589),
            (652, 607),
            (652, 597),
            (652, 603),
            (669, 603),
            (669, 597),
            (669, 601),
            (669, 566),
            (669, 596),
            (669, 565),
            (669, 582),
            (691, 601),
            (691, 596),
            (691, 602),
            (760, 570),
            (760, 564),
            (760, 535),
            (760, 534),
            (750, 569),
            (750, 533),
            (750, 583),
            (750, 532),
            (729, 530),
            (729, 514),
            (734, 507),
            (734, 547),
            (734, 579),
            (732, 506),
            (732, 541),
            (732, 571),
            (749, 551),
            (749, 578),
            (749, 577),
            (702, 590),
            (702, 577),
            (673, 597),
            (673, 589),
            (673, 590),
            (689, 565),
            (689, 566),
            (689, 597),
            (692, 582),
            (692, 596),
            (692, 601),
            (743, 570),
            (743, 564),
            (743, 581),
            (782, 515),
            (730, 579),
            (730, 547),
            (730, 586),
            (773, 556),
            (773, 540),
            (773, 505),
            (773, 523),
            (701, 590),
            (701, 589),
            (690, 589),
            (690, 585),
            (690, 597),
            (690, 563),
            (690, 566),
            (762, 565),
            (762, 538),
            (754, 582),
            (754, 576),
            (754, 575),
            (765, 562),
            (765, 545),
            (765, 536),
            (763, 550),
            (763, 555),
            (763, 567),
            (763, 556),
            (741, 585),
            (741, 568),
            (741, 567),
            (741, 556),
            (751, 563),
            (751, 585),
            (751, 568),
            (793, 519),
            (761, 503),
            (761, 518),
            (761, 576),
            (761, 582),
            (766, 575),
            (766, 561),
            (766, 562),
            (766, 554),
            (766, 545),
            (766, 536),
            (771, 539),
            (771, 504),
            (771, 549),
        ],
    },
    5: {
        "nbPairs": 187,
        "listPairs": [
            (614, 591),
            (614, 605),
            (615, 591),
            (615, 594),
            (634, 605),
            (634, 606),
            (634, 604),
            (645, 605),
            (645, 573),
            (645, 572),
            (636, 592),
            (636, 588),
            (636, 580),
            (636, 587),
            (657, 594),
            (657, 608),
            (635, 604),
            (635, 607),
            (635, 609),
            (635, 608),
            (679, 604),
            (679, 606),
            (623, 572),
            (623, 544),
            (623, 509),
            (655, 573),
            (655, 558),
            (655, 559),
            (624, 580),
            (624, 553),
            (624, 509),
            (658, 588),
            (658, 592),
            (658, 560),
            (670, 600),
            (670, 593),
            (670, 592),
            (660, 608),
            (660, 609),
            (650, 607),
            (650, 603),
            (650, 604),
            (684, 604),
            (684, 602),
            (699, 606),
            (699, 595),
            (687, 531),
            (687, 512),
            (687, 510),
            (687, 548),
            (659, 560),
            (659, 543),
            (659, 574),
            (659, 508),
            (659, 557),
            (659, 552),
            (676, 600),
            (676, 598),
            (672, 609),
            (672, 599),
            (651, 603),
            (651, 607),
            (664, 604),
            (664, 602),
            (664, 601),
            (745, 570),
            (745, 569),
            (714, 595),
            (714, 583),
            (714, 532),
            (727, 512),
            (727, 511),
            (727, 531),
            (727, 513),
            (727, 530),
            (727, 514),
            (656, 508),
            (733, 526),
            (733, 557),
            (733, 525),
            (733, 542),
            (731, 584),
            (731, 571),
            (731, 578),
            (731, 541),
            (731, 551),
            (731, 506),
            (675, 598),
            (675, 599),
            (652, 599),
            (652, 590),
            (652, 609),
            (652, 589),
            (652, 607),
            (652, 597),
            (652, 603),
            (669, 603),
            (669, 597),
            (669, 601),
            (669, 566),
            (669, 596),
            (669, 565),
            (669, 582),
            (691, 601),
            (691, 596),
            (691, 602),
            (760, 570),
            (760, 564),
            (760, 535),
            (760, 534),
            (750, 569),
            (750, 533),
            (750, 583),
            (750, 532),
            (729, 530),
            (729, 514),
            (734, 507),
            (734, 547),
            (734, 579),
            (732, 506),
            (732, 541),
            (732, 571),
            (749, 551),
            (749, 578),
            (749, 577),
            (702, 590),
            (702, 577),
            (673, 597),
            (673, 589),
            (673, 590),
            (689, 565),
            (689, 566),
            (689, 597),
            (692, 582),
            (692, 596),
            (692, 601),
            (743, 570),
            (743, 564),
            (743, 581),
            (782, 515),
            (730, 579),
            (730, 547),
            (730, 586),
            (773, 556),
            (773, 540),
            (773, 505),
            (773, 523),
            (701, 590),
            (701, 589),
            (690, 589),
            (690, 585),
            (690, 597),
            (690, 563),
            (690, 566),
            (762, 565),
            (762, 538),
            (754, 582),
            (754, 576),
            (754, 575),
            (765, 562),
            (765, 545),
            (765, 536),
            (763, 550),
            (763, 555),
            (763, 567),
            (763, 556),
            (741, 585),
            (741, 568),
            (741, 567),
            (741, 556),
            (751, 563),
            (751, 585),
            (751, 568),
            (793, 519),
            (761, 503),
            (761, 518),
            (761, 576),
            (761, 582),
            (766, 575),
            (766, 561),
            (766, 562),
            (766, 554),
            (766, 545),
            (766, 536),
            (771, 539),
            (771, 504),
            (771, 549),
        ],
    },
    6: {
        "nbPairs": 195,
        "listPairs": [
            (614, 591),
            (614, 605),
            (615, 591),
            (615, 594),
            (623, 509),
            (623, 544),
            (623, 572),
            (624, 509),
            (624, 553),
            (624, 580),
            (634, 604),
            (634, 605),
            (634, 606),
            (635, 604),
            (635, 607),
            (635, 608),
            (635, 609),
            (636, 580),
            (636, 587),
            (636, 588),
            (636, 592),
            (645, 572),
            (645, 573),
            (645, 605),
            (646, 527),
            (650, 603),
            (650, 604),
            (650, 607),
            (651, 603),
            (651, 607),
            (652, 589),
            (652, 590),
            (652, 597),
            (652, 599),
            (652, 603),
            (652, 607),
            (652, 609),
            (655, 558),
            (655, 559),
            (655, 573),
            (656, 508),
            (657, 594),
            (657, 608),
            (658, 560),
            (658, 588),
            (658, 592),
            (659, 508),
            (659, 543),
            (659, 552),
            (659, 557),
            (659, 560),
            (659, 574),
            (660, 608),
            (660, 609),
            (664, 601),
            (664, 602),
            (664, 604),
            (669, 565),
            (669, 566),
            (669, 582),
            (669, 596),
            (669, 597),
            (669, 601),
            (669, 603),
            (670, 592),
            (670, 593),
            (670, 600),
            (671, 586),
            (671, 592),
            (671, 593),
            (672, 599),
            (672, 609),
            (673, 589),
            (673, 590),
            (673, 597),
            (675, 598),
            (675, 599),
            (676, 598),
            (676, 600),
            (679, 604),
            (679, 606),
            (684, 602),
            (684, 604),
            (687, 510),
            (687, 512),
            (687, 531),
            (687, 548),
            (689, 565),
            (689, 566),
            (689, 597),
            (690, 563),
            (690, 566),
            (690, 585),
            (690, 589),
            (690, 597),
            (691, 596),
            (691, 601),
            (691, 602),
            (692, 582),
            (692, 596),
            (692, 601),
            (699, 595),
            (699, 606),
            (701, 589),
            (701, 590),
            (702, 577),
            (702, 590),
            (714, 532),
            (714, 583),
            (714, 595),
            (727, 511),
            (727, 512),
            (727, 513),
            (727, 514),
            (727, 530),
            (727, 531),
            (729, 514),
            (729, 530),
            (730, 547),
            (730, 579),
            (730, 586),
            (731, 506),
            (731, 541),
            (731, 551),
            (731, 571),
            (731, 578),
            (731, 584),
            (732, 506),
            (732, 541),
            (732, 571),
            (733, 525),
            (733, 526),
            (733, 542),
            (733, 557),
            (734, 507),
            (734, 547),
            (734, 579),
            (741, 556),
            (741, 567),
            (741, 568),
            (741, 585),
            (743, 564),
            (743, 570),
            (743, 581),
            (745, 569),
            (745, 570),
            (749, 551),
            (749, 577),
            (749, 578),
            (750, 532),
            (750, 533),
            (750, 569),
            (750, 583),
            (751, 563),
            (751, 568),
            (751, 585),
            (754, 575),
            (754, 576),
            (754, 582),
            (760, 534),
            (760, 535),
            (760, 564),
            (760, 570),
            (761, 503),
            (761, 518),
            (761, 576),
            (761, 582),
            (762, 538),
            (762, 565),
            (763, 550),
            (763, 555),
            (763, 556),
            (763, 567),
            (765, 536),
            (765, 545),
            (765, 562),
            (766, 536),
            (766, 545),
            (766, 554),
            (766, 561),
            (766, 562),
            (766, 575),
            (771, 504),
            (771, 539),
            (771, 549),
            (773, 505),
            (773, 523),
            (773, 540),
            (773, 556),
            (782, 515),
            (793, 519),
            (803, 517),
            (803, 537),
            (811, 521),
            (811, 522),
        ],
    },
}
# -------------------------------------
#       - Read mesh and set model
# -------------------------------------
DEBUT(CODE="OUI", ERREUR=_F(ALARME="ALARME"), INFO=1)

test = CA.TestCase()

Mail = LIRE_MAILLAGE(UNITE=20, FORMAT="MED")

Mail = MODI_MAILLAGE(
    reuse=Mail, MAILLAGE=Mail, ORIE_PEAU=_F(GROUP_MA_PEAU=("CONT_HAUT", "CONT_BAS"))
)

MODI = AFFE_MODELE(MAILLAGE=Mail, AFFE=_F(TOUT="OUI", PHENOMENE="MECANIQUE", MODELISATION="3D"))

# -------------------------------------
#       - CONFIG: SLAVE="CONT_BAS" + PairingMethod.Fast
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_BAS", "CONT_HAUT")
meshPair.setMethod(PairingMethod.Fast)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[1]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[1]["listPairs"])

# -------------------------------------
#       - CONFIG: SLAVE="CONT_BAS" + PairingMethod.Legacy
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_BAS", "CONT_HAUT")
meshPair.setMethod(PairingMethod.Legacy)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[2]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[2]["listPairs"])

# -------------------------------------
#       - CONFIG: SLAVE="CONT_BAS" + PairingMethod.BrutForce
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_BAS", "CONT_HAUT")
meshPair.setMethod(PairingMethod.BrutForce)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[3]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[3]["listPairs"])

# -------------------------------------
#       - CONFIG: SLAVE="CONT_HAUT" + PairingMethod.Fast
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_HAUT", "CONT_BAS")
meshPair.setMethod(PairingMethod.Fast)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[4]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[4]["listPairs"])

# -------------------------------------
#       - CONFIG: SLAVE="CONT_HAUT" + PairingMethod.Legacy
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_HAUT", "CONT_BAS")
meshPair.setMethod(PairingMethod.Legacy)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[5]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[5]["listPairs"])

# -------------------------------------
#       - CONFIG: SLAVE="CONT_HAUT" + PairingMethod.BrutForce
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_HAUT", "CONT_BAS")
meshPair.setMethod(PairingMethod.BrutForce)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[6]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[6]["listPairs"])

FIN()
