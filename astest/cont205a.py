# coding=utf-8
# --------------------------------------------------------------------
# Copyright (C) 1991 - 2025 - EDF R&D - www.code-aster.org
# This file is part of code_aster.
#
# code_aster is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# code_aster is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with code_aster.  If not, see <http://www.gnu.org/licenses/>.
# --------------------------------------------------------------------
## - Pairing test in 3D for linear meshes: TETRA4 vs HEXA8

from code_aster.Commands import *
from code_aster import CA
from enum import Enum
from code_aster.MacroCommands.defi_cont import DEFI_CONT
from libaster import ContactPairing, ContactComputation, PairingMethod
import numpy

# -------------------------------------
#       - Reference solution
# -------------------------------------
"""
    1: SLAVE = CONT_BAS + PairingMethod.Fast
"""
refValues = {
    1: {
        "nbPairs": 251,
        "listPairs": [
            (632, 119),
            (632, 158),
            (632, 118),
            (632, 160),
            (632, 159),
            (632, 151),
            (632, 164),
            (632, 179),
            (632, 168),
            (632, 180),
            (632, 239),
            (632, 203),
            (632, 279),
            (632, 238),
            (632, 212),
            (632, 310),
            (632, 280),
            (632, 282),
            (632, 309),
            (632, 296),
            (631, 310),
            (631, 279),
            (631, 321),
            (631, 239),
            (631, 270),
            (631, 311),
            (631, 344),
            (631, 179),
            (631, 223),
            (631, 281),
            (631, 330),
            (631, 180),
            (631, 244),
            (631, 276),
            (631, 326),
            (631, 305),
            (639, 180),
            (639, 164),
            (639, 160),
            (639, 158),
            (639, 161),
            (639, 119),
            (639, 162),
            (639, 174),
            (639, 147),
            (639, 118),
            (639, 177),
            (639, 194),
            (639, 135),
            (639, 151),
            (639, 185),
            (639, 195),
            (639, 181),
            (633, 296),
            (633, 286),
            (633, 282),
            (633, 248),
            (633, 211),
            (633, 212),
            (633, 243),
            (633, 209),
            (633, 210),
            (633, 203),
            (633, 166),
            (633, 167),
            (633, 168),
            (633, 149),
            (633, 133),
            (633, 150),
            (633, 151),
            (633, 117),
            (633, 126),
            (633, 127),
            (633, 97),
            (633, 107),
            (625, 296),
            (625, 282),
            (625, 317),
            (625, 280),
            (625, 318),
            (625, 309),
            (625, 320),
            (625, 310),
            (625, 345),
            (630, 326),
            (630, 361),
            (630, 330),
            (638, 305),
            (638, 276),
            (638, 306),
            (638, 326),
            (638, 244),
            (638, 290),
            (638, 324),
            (638, 223),
            (638, 245),
            (638, 274),
            (638, 291),
            (638, 180),
            (638, 175),
            (638, 226),
            (638, 292),
            (638, 164),
            (638, 176),
            (638, 230),
            (638, 273),
            (638, 160),
            (638, 174),
            (638, 229),
            (638, 161),
            (638, 194),
            (624, 344),
            (624, 321),
            (624, 345),
            (624, 310),
            (624, 320),
            (624, 309),
            (646, 181),
            (646, 186),
            (646, 185),
            (646, 221),
            (646, 191),
            (646, 177),
            (646, 220),
            (646, 218),
            (646, 195),
            (646, 250),
            (646, 269),
            (646, 217),
            (646, 194),
            (646, 251),
            (646, 335),
            (646, 231),
            (646, 340),
            (646, 304),
            (640, 181),
            (640, 135),
            (640, 186),
            (640, 99),
            (640, 147),
            (640, 136),
            (640, 98),
            (640, 120),
            (640, 119),
            (640, 137),
            (640, 118),
            (640, 127),
            (640, 108),
            (640, 134),
            (640, 151),
            (640, 107),
            (640, 150),
            (640, 128),
            (640, 165),
            (640, 117),
            (640, 100),
            (640, 97),
            (640, 126),
            (634, 126),
            (634, 106),
            (634, 133),
            (626, 248),
            (626, 286),
            (626, 296),
            (626, 317),
            (637, 361),
            (637, 326),
            (637, 325),
            (637, 305),
            (637, 324),
            (637, 366),
            (637, 306),
            (637, 291),
            (637, 352),
            (637, 292),
            (645, 194),
            (645, 195),
            (645, 229),
            (645, 217),
            (645, 231),
            (645, 230),
            (645, 304),
            (645, 273),
            (645, 340),
            (645, 303),
            (645, 292),
            (645, 359),
            (645, 323),
            (645, 352),
            (645, 357),
            (645, 342),
            (653, 340),
            (653, 335),
            (653, 359),
            (653, 269),
            (653, 337),
            (653, 369),
            (653, 250),
            (653, 332),
            (653, 368),
            (653, 251),
            (653, 322),
            (647, 251),
            (647, 249),
            (647, 250),
            (647, 242),
            (647, 257),
            (647, 220),
            (647, 205),
            (647, 221),
            (647, 256),
            (647, 137),
            (647, 201),
            (647, 186),
            (647, 202),
            (647, 134),
            (647, 136),
            (647, 165),
            (647, 181),
            (647, 192),
            (647, 153),
            (647, 170),
            (641, 126),
            (641, 106),
            (641, 97),
            (641, 109),
            (641, 100),
            (641, 121),
            (641, 128),
            (641, 153),
            (641, 134),
            (641, 170),
            (641, 165),
            (644, 292),
            (644, 352),
            (644, 342),
            (644, 366),
            (652, 357),
            (652, 359),
            (652, 340),
            (652, 369),
            (654, 322),
            (654, 257),
            (654, 332),
            (654, 249),
            (654, 256),
            (654, 251),
            (648, 170),
            (648, 153),
            (648, 192),
            (648, 165),
        ],
    },
    2: {
        "nbPairs": 251,
        "listPairs": [
            (632, 119),
            (632, 158),
            (632, 118),
            (632, 160),
            (632, 159),
            (632, 151),
            (632, 164),
            (632, 179),
            (632, 168),
            (632, 180),
            (632, 239),
            (632, 203),
            (632, 279),
            (632, 238),
            (632, 212),
            (632, 310),
            (632, 280),
            (632, 282),
            (632, 309),
            (632, 296),
            (631, 310),
            (631, 279),
            (631, 321),
            (631, 239),
            (631, 270),
            (631, 311),
            (631, 344),
            (631, 179),
            (631, 223),
            (631, 281),
            (631, 330),
            (631, 180),
            (631, 244),
            (631, 276),
            (631, 326),
            (631, 305),
            (639, 180),
            (639, 164),
            (639, 160),
            (639, 158),
            (639, 161),
            (639, 119),
            (639, 162),
            (639, 174),
            (639, 147),
            (639, 118),
            (639, 177),
            (639, 194),
            (639, 135),
            (639, 151),
            (639, 185),
            (639, 195),
            (639, 181),
            (633, 296),
            (633, 286),
            (633, 282),
            (633, 248),
            (633, 211),
            (633, 212),
            (633, 243),
            (633, 209),
            (633, 210),
            (633, 203),
            (633, 166),
            (633, 167),
            (633, 168),
            (633, 149),
            (633, 133),
            (633, 150),
            (633, 151),
            (633, 117),
            (633, 126),
            (633, 127),
            (633, 97),
            (633, 107),
            (625, 296),
            (625, 282),
            (625, 317),
            (625, 280),
            (625, 318),
            (625, 309),
            (625, 320),
            (625, 310),
            (625, 345),
            (630, 326),
            (630, 361),
            (630, 330),
            (638, 305),
            (638, 276),
            (638, 306),
            (638, 326),
            (638, 244),
            (638, 290),
            (638, 324),
            (638, 223),
            (638, 245),
            (638, 274),
            (638, 291),
            (638, 180),
            (638, 175),
            (638, 226),
            (638, 292),
            (638, 164),
            (638, 176),
            (638, 230),
            (638, 273),
            (638, 160),
            (638, 174),
            (638, 229),
            (638, 161),
            (638, 194),
            (624, 344),
            (624, 321),
            (624, 345),
            (624, 310),
            (624, 320),
            (624, 309),
            (646, 181),
            (646, 186),
            (646, 185),
            (646, 221),
            (646, 191),
            (646, 177),
            (646, 220),
            (646, 218),
            (646, 195),
            (646, 250),
            (646, 269),
            (646, 217),
            (646, 194),
            (646, 251),
            (646, 335),
            (646, 231),
            (646, 340),
            (646, 304),
            (640, 181),
            (640, 135),
            (640, 186),
            (640, 99),
            (640, 147),
            (640, 136),
            (640, 98),
            (640, 120),
            (640, 119),
            (640, 137),
            (640, 118),
            (640, 127),
            (640, 108),
            (640, 134),
            (640, 151),
            (640, 107),
            (640, 150),
            (640, 128),
            (640, 165),
            (640, 117),
            (640, 100),
            (640, 97),
            (640, 126),
            (634, 126),
            (634, 106),
            (634, 133),
            (626, 248),
            (626, 286),
            (626, 296),
            (626, 317),
            (637, 361),
            (637, 326),
            (637, 325),
            (637, 305),
            (637, 324),
            (637, 366),
            (637, 306),
            (637, 291),
            (637, 352),
            (637, 292),
            (645, 194),
            (645, 195),
            (645, 229),
            (645, 217),
            (645, 231),
            (645, 230),
            (645, 304),
            (645, 273),
            (645, 340),
            (645, 303),
            (645, 292),
            (645, 359),
            (645, 323),
            (645, 352),
            (645, 357),
            (645, 342),
            (653, 340),
            (653, 335),
            (653, 359),
            (653, 269),
            (653, 337),
            (653, 369),
            (653, 250),
            (653, 332),
            (653, 368),
            (653, 251),
            (653, 322),
            (647, 251),
            (647, 249),
            (647, 250),
            (647, 242),
            (647, 257),
            (647, 220),
            (647, 205),
            (647, 221),
            (647, 256),
            (647, 137),
            (647, 201),
            (647, 186),
            (647, 202),
            (647, 134),
            (647, 136),
            (647, 165),
            (647, 181),
            (647, 192),
            (647, 153),
            (647, 170),
            (641, 126),
            (641, 106),
            (641, 97),
            (641, 109),
            (641, 100),
            (641, 121),
            (641, 128),
            (641, 153),
            (641, 134),
            (641, 170),
            (641, 165),
            (644, 292),
            (644, 352),
            (644, 342),
            (644, 366),
            (652, 357),
            (652, 359),
            (652, 340),
            (652, 369),
            (654, 322),
            (654, 257),
            (654, 332),
            (654, 249),
            (654, 256),
            (654, 251),
            (648, 170),
            (648, 153),
            (648, 192),
            (648, 165),
        ],
    },
    3: {
        "nbPairs": 251,
        "listPairs": [
            (624, 309),
            (624, 310),
            (624, 320),
            (624, 321),
            (624, 344),
            (624, 345),
            (625, 280),
            (625, 282),
            (625, 296),
            (625, 309),
            (625, 310),
            (625, 317),
            (625, 318),
            (625, 320),
            (625, 345),
            (626, 248),
            (626, 286),
            (626, 296),
            (626, 317),
            (630, 326),
            (630, 330),
            (630, 361),
            (631, 179),
            (631, 180),
            (631, 223),
            (631, 239),
            (631, 244),
            (631, 270),
            (631, 276),
            (631, 279),
            (631, 281),
            (631, 305),
            (631, 310),
            (631, 311),
            (631, 321),
            (631, 326),
            (631, 330),
            (631, 344),
            (632, 118),
            (632, 119),
            (632, 151),
            (632, 158),
            (632, 159),
            (632, 160),
            (632, 164),
            (632, 168),
            (632, 179),
            (632, 180),
            (632, 203),
            (632, 212),
            (632, 238),
            (632, 239),
            (632, 279),
            (632, 280),
            (632, 282),
            (632, 296),
            (632, 309),
            (632, 310),
            (633, 97),
            (633, 107),
            (633, 117),
            (633, 126),
            (633, 127),
            (633, 133),
            (633, 149),
            (633, 150),
            (633, 151),
            (633, 166),
            (633, 167),
            (633, 168),
            (633, 203),
            (633, 209),
            (633, 210),
            (633, 211),
            (633, 212),
            (633, 243),
            (633, 248),
            (633, 282),
            (633, 286),
            (633, 296),
            (634, 106),
            (634, 126),
            (634, 133),
            (637, 291),
            (637, 292),
            (637, 305),
            (637, 306),
            (637, 324),
            (637, 325),
            (637, 326),
            (637, 352),
            (637, 361),
            (637, 366),
            (638, 160),
            (638, 161),
            (638, 164),
            (638, 174),
            (638, 175),
            (638, 176),
            (638, 180),
            (638, 194),
            (638, 223),
            (638, 226),
            (638, 229),
            (638, 230),
            (638, 244),
            (638, 245),
            (638, 273),
            (638, 274),
            (638, 276),
            (638, 290),
            (638, 291),
            (638, 292),
            (638, 305),
            (638, 306),
            (638, 324),
            (638, 326),
            (639, 118),
            (639, 119),
            (639, 135),
            (639, 147),
            (639, 151),
            (639, 158),
            (639, 160),
            (639, 161),
            (639, 162),
            (639, 164),
            (639, 174),
            (639, 177),
            (639, 180),
            (639, 181),
            (639, 185),
            (639, 194),
            (639, 195),
            (640, 97),
            (640, 98),
            (640, 99),
            (640, 100),
            (640, 107),
            (640, 108),
            (640, 117),
            (640, 118),
            (640, 119),
            (640, 120),
            (640, 126),
            (640, 127),
            (640, 128),
            (640, 134),
            (640, 135),
            (640, 136),
            (640, 137),
            (640, 147),
            (640, 150),
            (640, 151),
            (640, 165),
            (640, 181),
            (640, 186),
            (641, 97),
            (641, 100),
            (641, 106),
            (641, 109),
            (641, 121),
            (641, 126),
            (641, 128),
            (641, 134),
            (641, 153),
            (641, 165),
            (641, 170),
            (644, 292),
            (644, 342),
            (644, 352),
            (644, 366),
            (645, 194),
            (645, 195),
            (645, 217),
            (645, 229),
            (645, 230),
            (645, 231),
            (645, 273),
            (645, 292),
            (645, 303),
            (645, 304),
            (645, 323),
            (645, 340),
            (645, 342),
            (645, 352),
            (645, 357),
            (645, 359),
            (646, 177),
            (646, 181),
            (646, 185),
            (646, 186),
            (646, 191),
            (646, 194),
            (646, 195),
            (646, 217),
            (646, 218),
            (646, 220),
            (646, 221),
            (646, 231),
            (646, 250),
            (646, 251),
            (646, 269),
            (646, 304),
            (646, 335),
            (646, 340),
            (647, 134),
            (647, 136),
            (647, 137),
            (647, 153),
            (647, 165),
            (647, 170),
            (647, 181),
            (647, 186),
            (647, 192),
            (647, 201),
            (647, 202),
            (647, 205),
            (647, 220),
            (647, 221),
            (647, 242),
            (647, 249),
            (647, 250),
            (647, 251),
            (647, 256),
            (647, 257),
            (648, 153),
            (648, 165),
            (648, 170),
            (648, 192),
            (652, 340),
            (652, 357),
            (652, 359),
            (652, 369),
            (653, 250),
            (653, 251),
            (653, 269),
            (653, 322),
            (653, 332),
            (653, 335),
            (653, 337),
            (653, 340),
            (653, 359),
            (653, 368),
            (653, 369),
            (654, 249),
            (654, 251),
            (654, 256),
            (654, 257),
            (654, 322),
            (654, 332),
        ],
    },
    4: {
        "nbPairs": 161,
        "listPairs": [
            (98, 640),
            (98, 641),
            (98, 633),
            (98, 634),
            (99, 641),
            (99, 640),
            (99, 648),
            (99, 647),
            (118, 633),
            (118, 640),
            (127, 634),
            (127, 641),
            (120, 648),
            (120, 641),
            (135, 647),
            (135, 640),
            (119, 640),
            (119, 639),
            (119, 633),
            (119, 632),
            (151, 633),
            (151, 626),
            (107, 642),
            (107, 635),
            (150, 634),
            (150, 627),
            (108, 642),
            (108, 649),
            (136, 648),
            (136, 655),
            (181, 647),
            (181, 654),
            (147, 640),
            (147, 639),
            (147, 647),
            (147, 646),
            (158, 632),
            (158, 639),
            (168, 626),
            (168, 625),
            (168, 633),
            (168, 632),
            (117, 635),
            (167, 627),
            (167, 628),
            (137, 656),
            (137, 649),
            (186, 655),
            (186, 654),
            (186, 648),
            (186, 647),
            (185, 654),
            (185, 653),
            (185, 647),
            (185, 646),
            (162, 646),
            (162, 639),
            (160, 639),
            (160, 638),
            (160, 632),
            (160, 631),
            (159, 632),
            (159, 625),
            (203, 625),
            (203, 626),
            (203, 619),
            (149, 628),
            (210, 627),
            (210, 621),
            (210, 620),
            (205, 663),
            (221, 654),
            (221, 661),
            (221, 655),
            (221, 662),
            (191, 653),
            (191, 660),
            (191, 654),
            (177, 646),
            (177, 653),
            (161, 639),
            (161, 638),
            (161, 646),
            (161, 645),
            (164, 631),
            (164, 638),
            (179, 625),
            (179, 624),
            (179, 632),
            (179, 631),
            (238, 618),
            (238, 625),
            (212, 619),
            (212, 626),
            (212, 620),
            (242, 663),
            (242, 662),
            (220, 661),
            (220, 654),
            (218, 660),
            (218, 659),
            (218, 653),
            (195, 653),
            (195, 652),
            (195, 646),
            (195, 645),
            (174, 645),
            (174, 638),
            (175, 638),
            (175, 637),
            (175, 630),
            (180, 631),
            (180, 624),
            (239, 624),
            (239, 625),
            (239, 617),
            (239, 618),
            (217, 653),
            (217, 652),
            (217, 659),
            (194, 645),
            (176, 638),
            (176, 637),
            (176, 644),
            (245, 630),
            (245, 629),
            (245, 637),
            (223, 624),
            (223, 623),
            (223, 630),
            (279, 617),
            (279, 616),
            (279, 624),
            (231, 659),
            (231, 658),
            (231, 652),
            (231, 651),
            (229, 644),
            (229, 652),
            (229, 651),
            (226, 644),
            (226, 643),
            (226, 637),
            (290, 636),
            (290, 629),
            (244, 629),
            (244, 630),
            (244, 623),
            (270, 623),
            (270, 616),
            (304, 658),
            (230, 651),
            (230, 650),
            (230, 644),
            (230, 643),
            (274, 636),
            (274, 643),
            (276, 622),
            (281, 615),
            (273, 650),
            (273, 657),
        ],
    },
    5: {
        "nbPairs": 161,
        "listPairs": [
            (98, 640),
            (98, 641),
            (98, 633),
            (98, 634),
            (99, 641),
            (99, 640),
            (99, 648),
            (99, 647),
            (118, 633),
            (118, 640),
            (127, 634),
            (127, 641),
            (120, 648),
            (120, 641),
            (135, 647),
            (135, 640),
            (119, 640),
            (119, 639),
            (119, 633),
            (119, 632),
            (151, 633),
            (151, 626),
            (107, 642),
            (107, 635),
            (150, 634),
            (150, 627),
            (108, 642),
            (108, 649),
            (136, 648),
            (136, 655),
            (181, 647),
            (181, 654),
            (147, 640),
            (147, 639),
            (147, 647),
            (147, 646),
            (158, 632),
            (158, 639),
            (168, 626),
            (168, 625),
            (168, 633),
            (168, 632),
            (117, 635),
            (167, 627),
            (167, 628),
            (137, 656),
            (137, 649),
            (186, 655),
            (186, 654),
            (186, 648),
            (186, 647),
            (185, 654),
            (185, 653),
            (185, 647),
            (185, 646),
            (162, 646),
            (162, 639),
            (160, 639),
            (160, 638),
            (160, 632),
            (160, 631),
            (159, 632),
            (159, 625),
            (203, 625),
            (203, 626),
            (203, 619),
            (149, 628),
            (210, 627),
            (210, 621),
            (210, 620),
            (205, 663),
            (221, 654),
            (221, 661),
            (221, 655),
            (221, 662),
            (191, 653),
            (191, 660),
            (191, 654),
            (177, 646),
            (177, 653),
            (161, 639),
            (161, 638),
            (161, 646),
            (161, 645),
            (164, 631),
            (164, 638),
            (179, 625),
            (179, 624),
            (179, 632),
            (179, 631),
            (238, 618),
            (238, 625),
            (212, 619),
            (212, 626),
            (212, 620),
            (242, 663),
            (242, 662),
            (220, 661),
            (220, 654),
            (218, 660),
            (218, 659),
            (218, 653),
            (195, 653),
            (195, 652),
            (195, 646),
            (195, 645),
            (174, 645),
            (174, 638),
            (175, 638),
            (175, 637),
            (175, 630),
            (180, 631),
            (180, 624),
            (239, 624),
            (239, 625),
            (239, 617),
            (239, 618),
            (217, 653),
            (217, 652),
            (217, 659),
            (194, 645),
            (176, 638),
            (176, 637),
            (176, 644),
            (245, 630),
            (245, 629),
            (245, 637),
            (223, 624),
            (223, 623),
            (223, 630),
            (279, 617),
            (279, 616),
            (279, 624),
            (231, 659),
            (231, 658),
            (231, 652),
            (231, 651),
            (229, 644),
            (229, 652),
            (229, 651),
            (226, 644),
            (226, 643),
            (226, 637),
            (290, 636),
            (290, 629),
            (244, 629),
            (244, 630),
            (244, 623),
            (270, 623),
            (270, 616),
            (304, 658),
            (230, 651),
            (230, 650),
            (230, 644),
            (230, 643),
            (274, 636),
            (274, 643),
            (276, 622),
            (281, 615),
            (273, 650),
            (273, 657),
        ],
    },
    6: {
        "nbPairs": 161,
        "listPairs": [
            (98, 633),
            (98, 634),
            (98, 640),
            (98, 641),
            (99, 640),
            (99, 641),
            (99, 647),
            (99, 648),
            (107, 635),
            (107, 642),
            (108, 642),
            (108, 649),
            (117, 635),
            (118, 633),
            (118, 640),
            (119, 632),
            (119, 633),
            (119, 639),
            (119, 640),
            (120, 641),
            (120, 648),
            (127, 634),
            (127, 641),
            (135, 640),
            (135, 647),
            (136, 648),
            (136, 655),
            (137, 649),
            (137, 656),
            (147, 639),
            (147, 640),
            (147, 646),
            (147, 647),
            (149, 628),
            (150, 627),
            (150, 634),
            (151, 626),
            (151, 633),
            (158, 632),
            (158, 639),
            (159, 625),
            (159, 632),
            (160, 631),
            (160, 632),
            (160, 638),
            (160, 639),
            (161, 638),
            (161, 639),
            (161, 645),
            (161, 646),
            (162, 639),
            (162, 646),
            (164, 631),
            (164, 638),
            (167, 627),
            (167, 628),
            (168, 625),
            (168, 626),
            (168, 632),
            (168, 633),
            (174, 638),
            (174, 645),
            (175, 630),
            (175, 637),
            (175, 638),
            (176, 637),
            (176, 638),
            (176, 644),
            (177, 646),
            (177, 653),
            (179, 624),
            (179, 625),
            (179, 631),
            (179, 632),
            (180, 624),
            (180, 631),
            (181, 647),
            (181, 654),
            (185, 646),
            (185, 647),
            (185, 653),
            (185, 654),
            (186, 647),
            (186, 648),
            (186, 654),
            (186, 655),
            (191, 653),
            (191, 654),
            (191, 660),
            (194, 645),
            (195, 645),
            (195, 646),
            (195, 652),
            (195, 653),
            (203, 619),
            (203, 625),
            (203, 626),
            (205, 663),
            (210, 620),
            (210, 621),
            (210, 627),
            (212, 619),
            (212, 620),
            (212, 626),
            (217, 652),
            (217, 653),
            (217, 659),
            (218, 653),
            (218, 659),
            (218, 660),
            (220, 654),
            (220, 661),
            (221, 654),
            (221, 655),
            (221, 661),
            (221, 662),
            (223, 623),
            (223, 624),
            (223, 630),
            (226, 637),
            (226, 643),
            (226, 644),
            (229, 644),
            (229, 651),
            (229, 652),
            (230, 643),
            (230, 644),
            (230, 650),
            (230, 651),
            (231, 651),
            (231, 652),
            (231, 658),
            (231, 659),
            (238, 618),
            (238, 625),
            (239, 617),
            (239, 618),
            (239, 624),
            (239, 625),
            (242, 662),
            (242, 663),
            (244, 623),
            (244, 629),
            (244, 630),
            (245, 629),
            (245, 630),
            (245, 637),
            (270, 616),
            (270, 623),
            (273, 650),
            (273, 657),
            (274, 636),
            (274, 643),
            (276, 622),
            (279, 616),
            (279, 617),
            (279, 624),
            (281, 615),
            (290, 629),
            (290, 636),
            (304, 658),
        ],
    },
}
# -------------------------------------
#       - Read mesh and set model
# -------------------------------------
DEBUT(CODE="OUI", ERREUR=_F(ALARME="ALARME"), INFO=1)
test = CA.TestCase()

Mail = LIRE_MAILLAGE(UNITE=20, FORMAT="MED")

Mail = MODI_MAILLAGE(
    reuse=Mail, MAILLAGE=Mail, ORIE_PEAU=_F(GROUP_MA_PEAU=("CONT_HAUT", "CONT_BAS"))
)

MODI = AFFE_MODELE(MAILLAGE=Mail, AFFE=_F(TOUT="OUI", PHENOMENE="MECANIQUE", MODELISATION="3D"))

# -------------------------------------
#       - CONFIG: SLAVE="CONT_BAS" + PairingMethod.Fast
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_BAS", "CONT_HAUT")
meshPair.setMethod(PairingMethod.Fast)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[1]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[1]["listPairs"])

# -------------------------------------
#       - CONFIG: SLAVE="CONT_BAS" + PairingMethod.Legacy
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_BAS", "CONT_HAUT")
meshPair.setMethod(PairingMethod.Legacy)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[2]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[2]["listPairs"])

# -------------------------------------
#       - CONFIG: SLAVE="CONT_BAS" + PairingMethod.BrutForce
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_BAS", "CONT_HAUT")
meshPair.setMethod(PairingMethod.BrutForce)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[3]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[3]["listPairs"])

# -------------------------------------
#       - CONFIG: SLAVE="CONT_HAUT" + PairingMethod.Fast
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_HAUT", "CONT_BAS")
meshPair.setMethod(PairingMethod.Fast)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[4]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[4]["listPairs"])

# -------------------------------------
#       - CONFIG: SLAVE="CONT_HAUT" + PairingMethod.Legacy
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_HAUT", "CONT_BAS")
meshPair.setMethod(PairingMethod.Legacy)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[5]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[5]["listPairs"])

# -------------------------------------
#       - CONFIG: SLAVE="CONT_HAUT" + PairingMethod.BrutForce
# -------------------------------------
# Generate pairs
meshPair = CA.MeshPairing()
meshPair.setMesh(Mail)
meshPair.setVerbosity(1)
meshPair.setPair("CONT_HAUT", "CONT_BAS")
meshPair.setMethod(PairingMethod.BrutForce)
meshPair.compute()

# Get pairs
nbPairs = meshPair.getNumberOfPairs()
test.assertEqual(refValues[6]["nbPairs"], nbPairs)

if nbPairs != 0:
    listPairs = meshPair.getListOfPairs()
    test.assertSequenceEqual(listPairs, refValues[6]["listPairs"])

FIN()
